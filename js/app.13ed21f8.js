(function(){"use strict";var e={5648:function(e,t,n){var o=n(9242),m=n(3396);const s={class:"main"},r={class:"container"};function i(e,t,n,i,c,d){const l=(0,m.up)("CommentBox"),a=(0,m.up)("CommentForm"),u=(0,m.up)("ModalDelete");return(0,m.wg)(),(0,m.iD)("main",s,[(0,m._)("div",r,[(0,m.Wm)(o.W3,{name:"list",tag:"div"},{default:(0,m.w5)((()=>[((0,m.wg)(!0),(0,m.iD)(m.HY,null,(0,m.Ko)(d.comments,(e=>((0,m.wg)(),(0,m.iD)("div",{key:e.id},[(0,m.Wm)(l,{comment:e,currentUser:d.currentUser,onAddComment:t=>d.addComment({commentId:e.id,content:t}),onUpdateComment:t=>d.updateComment({commentId:e.id},t),onShowModal:t=>d.displayModal({commentId:e.id}),onIncrementVote:t=>d.incrementVote({commentId:e.id}),onDecrementVote:t=>d.decrementVote({commentId:e.id})},{replies:(0,m.w5)((({replies:t})=>[(0,m.Wm)(o.W3,{name:"list",tag:"div"},{default:(0,m.w5)((()=>[((0,m.wg)(!0),(0,m.iD)(m.HY,null,(0,m.Ko)(t,(t=>((0,m.wg)(),(0,m.iD)("div",{key:t.id},[(0,m.Wm)(l,{comment:t,currentUser:d.currentUser,onAddComment:t=>d.addComment({commentId:e.id,content:t}),onUpdateComment:n=>d.updateComment({commentId:e.id,replyId:t.id},n),onShowModal:n=>d.displayModal({commentId:e.id,replyId:t.id}),onIncrementVote:n=>d.incrementVote({commentId:e.id,replyId:t.id}),onDecrementVote:n=>d.decrementVote({commentId:e.id,replyId:t.id})},null,8,["comment","currentUser","onAddComment","onUpdateComment","onShowModal","onIncrementVote","onDecrementVote"])])))),128))])),_:2},1024)])),_:2},1032,["comment","currentUser","onAddComment","onUpdateComment","onShowModal","onIncrementVote","onDecrementVote"])])))),128))])),_:1}),(0,m.Wm)(a,{currentUser:d.currentUser,btnName:"Send",onAddComment:t[0]||(t[0]=e=>d.addComment({content:e}))},null,8,["currentUser"]),((0,m.wg)(),(0,m.j4)(m.lR,{to:"#modal-root"},[(0,m.wy)((0,m.Wm)(u,{onShowModal:t[1]||(t[1]=e=>d.toggleModal({commentId:c.deletedCommentId,replyId:c.deletedReplyId})),onDeleteComment:t[2]||(t[2]=e=>d.deleteComment({commentId:c.deletedCommentId,replyId:c.deletedReplyId}))},null,512),[[o.F8,c.showModal]])]))])])}var c=n(5743),d=n.n(c),l=n(922),a=n.n(l),u=n(7139),p=n.p+"img/icon-plus.19e25c8e.svg",g=n.p+"img/icon-minus.ddd2a6d4.svg",h=n.p+"img/icon-delete.f314ad3f.svg",C=n.p+"img/icon-edit.ff1ce63f.svg",y=n.p+"img/icon-reply.23d7b637.svg";const w={class:"comments"},_={class:"comments__header"},f=["src","alt"],I={class:"comments__name"},v={key:0,class:"comments__badge"},b={class:"comments__date"},U={class:"comments__body"},k={key:0,class:"comments__body-mention"},A={key:1},D={class:"comments__voting"},M=(0,m._)("span",null,[(0,m._)("img",{src:p,alt:"Edit Icon"})],-1),S=[M],x=["value"],$=(0,m._)("span",null,[(0,m._)("img",{src:g,alt:"Edit Icon"})],-1),O=[$],R={class:"comments__actions"},T=["disabled"],V=(0,m._)("span",{class:"actions-btn__icon"},[(0,m._)("img",{src:h,alt:"Delete Icon"})],-1),N=(0,m.Uk)(" Delete "),E=[V,N],W=(0,m._)("span",{class:"actions-btn__icon"},[(0,m._)("img",{src:C,alt:"Edit Icon"})],-1),j=(0,m.Uk)(" Edit "),J=[W,j],Y=(0,m._)("span",{class:"actions-btn__icon"},[(0,m._)("img",{src:y,alt:"Reply Icon"})],-1),F=(0,m.Uk)(" Reply "),P=[Y,F],z={class:"replies"};function H(e,t,n,s,r,i){const c=(0,m.up)("CommentForm");return(0,m.wg)(),(0,m.iD)(m.HY,null,[(0,m._)("article",w,[(0,m._)("div",_,[(0,m._)("img",{src:i.image,alt:i.commentUsername,class:"comments__header-image"},null,8,f),(0,m._)("h5",I,(0,u.zw)(i.commentUsername),1),i.isYou?((0,m.wg)(),(0,m.iD)("p",v,"you")):(0,m.kq)("",!0),(0,m._)("p",b,(0,u.zw)(i.createdAt),1)]),(0,m._)("div",U,[n.comment.replyingTo&&!r.showEdit?((0,m.wg)(),(0,m.iD)("span",k,"@"+(0,u.zw)(n.comment.replyingTo)+" Â ",1)):(0,m.kq)("",!0),r.showEdit?((0,m.wg)(),(0,m.iD)("div",A,[(0,m.wy)((0,m._)("textarea",{cols:"30",rows:"5",placeholder:"Add comment...",class:"comment-edit__input",ref:"editInput","onUpdate:modelValue":t[0]||(t[0]=e=>r.editComment=e),onKeydown:[t[1]||(t[1]=(0,o.D2)((0,o.iM)((()=>{}),["exact","prevent"]),["enter"])),t[2]||(t[2]=(0,o.D2)((0,o.iM)(((...e)=>i.onUpdateComment&&i.onUpdateComment(...e)),["exact"]),["enter"]))]},null,544),[[o.nr,r.editComment,void 0,{trim:!0}]]),(0,m._)("button",{class:"comment-edit__btn",onClick:t[3]||(t[3]=(...e)=>i.onUpdateComment&&i.onUpdateComment(...e))},"Update")])):((0,m.wg)(),(0,m.iD)(m.HY,{key:2},[(0,m.Uk)((0,u.zw)(n.comment.content),1)],64))]),(0,m._)("div",D,[(0,m._)("button",{class:(0,u.C_)(["vote-btn",{"vote-btn--disabled":1===n.comment.voting}]),onClick:t[4]||(t[4]=t=>e.$emit("increment-vote"))},S,2),(0,m._)("input",{type:"text",class:"input__vote",value:n.comment.score},null,8,x),(0,m._)("button",{class:(0,u.C_)(["vote-btn",{"vote-btn--disabled":-1===n.comment.voting}]),onClick:t[5]||(t[5]=t=>e.$emit("decrement-vote"))},O,2)]),(0,m._)("div",R,[i.isYou?((0,m.wg)(),(0,m.iD)(m.HY,{key:0},[(0,m._)("button",{class:(0,u.C_)(["actions-btn actions-btn--delete",{"actions-btn--delete--disabled":r.showEdit}]),disabled:r.showEdit,onClick:t[6]||(t[6]=t=>e.$emit("show-modal"))},E,10,T),(0,m._)("button",{class:"actions-btn actions-btn--edit",onClick:t[7]||(t[7]=(...e)=>i.toggleEdit&&i.toggleEdit(...e))},J)],64)):((0,m.wg)(),(0,m.iD)("button",{key:1,class:"actions-btn actions-btn--reply",onClick:t[8]||(t[8]=(...e)=>i.toggleReply&&i.toggleReply(...e))},P))])]),r.showReply?((0,m.wg)(),(0,m.j4)(c,{key:0,currentUser:n.currentUser,showReply:r.showReply,replyingTo:r.replyingTo,btnName:"Reply",onAddComment:i.onAddComment},null,8,["currentUser","showReply","replyingTo","onAddComment"])):(0,m.kq)("",!0),(0,m._)("article",z,[(0,m.WI)(e.$slots,"replies",{replies:n.comment.replies})])],64)}var B=n(893),K=n.n(B);const Z={class:"comment-form"},q=["src","alt"],G=["placeholder"];function L(e,t,n,s,r,i){return(0,m.wg)(),(0,m.iD)("article",Z,[(0,m._)("img",{src:i.imageWebp,alt:n.currentUser.username,class:"comment-form__image"},null,8,q),(0,m.wy)((0,m._)("textarea",{cols:"30",rows:"5",placeholder:i.placeholder,class:"comment-form__input",ref:"commentInput","onUpdate:modelValue":t[0]||(t[0]=e=>r.content=e),onKeydown:[t[1]||(t[1]=(0,o.D2)((0,o.iM)((()=>{}),["exact","prevent"]),["enter"])),t[2]||(t[2]=(0,o.D2)((0,o.iM)(((...e)=>i.onAddComment&&i.onAddComment(...e)),["exact"]),["enter"]))]},null,40,G),[[o.nr,r.content,void 0,{trim:!0}]]),(0,m._)("button",{class:"comment-form__btn",onClick:t[3]||(t[3]=(...e)=>i.onAddComment&&i.onAddComment(...e))},(0,u.zw)(n.btnName),1)])}var Q={name:"CommentForm",props:{currentUser:Object,showReply:Boolean,replyingTo:String,btnName:String},data(){return{content:null}},computed:{imageWebp(){return this.currentUser?.image?.webp},placeholder(){return this.showReply?"Add reply":"Add a comment..."}},watch:{showReply:{handler(e){e&&this.$nextTick((()=>{this.content=`@${this.replyingTo},`,this.$refs.commentInput.focus()}))},immediate:!0}},methods:{onAddComment(){this.$emit("add-comment",{content:this.content,replyingTo:this.replyingTo}),this.content=null}},emmits:["add-comment"]},X=n(89);const ee=(0,X.Z)(Q,[["render",L]]);var te=ee,ne={name:"CommentBox",props:{comment:Object,currentUser:Object},components:{CommentForm:te},data(){return{showReply:!1,replyingTo:null,showEdit:!1,editComment:null}},computed:{image(){return this.comment.user?.image?.webp},commentUsername(){return this.comment.user?.username},isYou(){return this.commentUsername===this.currentUser.username},createdAt(){d().extend(K());let e=d()(this.comment.createdAt).fromNow();return/^[a]/.test(e)&&(e=1+e.slice(1)),e.includes("days ago")&&(Number(e.split(" ")[0])>=21?e="3 weeks ago":Number(e.split(" ")[0])>=14?e="2 weeks ago":Number(e.split(" ")[0])>=7&&(e="1 week ago")),e}},watch:{showEdit(e){e&&this.$nextTick((()=>{this.editComment=this.comment.content,this.$refs.editInput.focus()}))},showReply(e){e&&(this.replyingTo=this.commentUsername)}},methods:{toggleReply(){this.showReply=!this.showReply},toggleEdit(){this.showEdit=!this.showEdit},onAddComment(e){this.$emit("add-comment",e),this.toggleReply()},onUpdateComment(){this.$emit("update-comment",this.editComment),this.toggleEdit()}},emits:["add-comment","update-comment","show-modal","increment-vote","decrement-vote"]};const oe=(0,X.Z)(ne,[["render",H]]);var me=oe;const se={class:"modal__card"},re=(0,m._)("h4",{class:"modal__header"},"Delete Comment",-1),ie=(0,m._)("p",{class:"modal__body"}," Are you sure you want to delete this comment? This will remove the comment and can't de undone. ",-1);function ce(e,t,n,s,r,i){return(0,m.wg)(),(0,m.iD)("div",{class:"modal",onClick:t[2]||(t[2]=(0,o.iM)((t=>e.$emit("show-modal")),["stop"]))},[(0,m._)("div",se,[re,ie,(0,m._)("button",{class:"modal__cancel-btn",onClick:t[0]||(t[0]=(0,o.iM)((t=>e.$emit("show-modal")),["stop"]))},"No, cancel"),(0,m._)("button",{class:"modal__confirm-btn",onClick:t[1]||(t[1]=(0,o.iM)((t=>e.$emit("delete-comment")),["stop"]))},"Yes, delete")])])}var de={name:"ModalDelete",emits:["show-modal","delete-comment"]};const le=(0,X.Z)(de,[["render",ce]]);var ae=le,ue={name:"App",components:{CommentBox:me,CommentForm:te,ModalDelete:ae},data(){return{showModal:!1,deletedCommentId:null,deletedReplyId:null}},computed:{comments(){return this.$store.getters.getAllComments},currentUser(){return this.$store.getters.getCurrentUser},imageWebp(){return this.currentUser?.image?.webp},imagePng(){return this.currentUser?.image?.png},createdAt(){return d().extend(a()),d().utc().local().format()}},created(){this.$store.dispatch("init")},methods:{addComment({commentId:e=null,content:{content:t,replyingTo:n}}){if(!t)return void alert("Please input a comment.");const{createdAt:o,imagePng:m,imageWebp:s,currentUser:{username:r}}=this;let i={};if(!e)return i={content:t,createdAt:o,score:0,voting:0,user:{image:{png:m,webp:s},username:r},replies:[]},void this.$store.dispatch("addComment",{commentId:e,comment:i});const c=t.split(",");i={content:c[c.length-1],createdAt:o,score:0,voting:0,replyingTo:n,user:{image:{png:m,webp:s},username:r}},this.$store.dispatch("addComment",{commentId:e,comment:i})},updateComment({commentId:e,replyId:t=null},n){n?this.$store.dispatch("updateComment",{commentId:e,replyId:t,editComment:n}):alert("Please input a comment.")},toggleModal(){this.showModal=!this.showModal},displayModal({commentId:e,replyId:t}){this.deletedCommentId=e,this.deletedReplyId=t,this.toggleModal()},deleteComment({commentId:e,replyId:t}){this.$store.dispatch("deleteComment",{commentId:e,replyId:t}),this.toggleModal()},incrementVote({commentId:e,replyId:t=null}){this.$store.dispatch("setVote",{commentId:e,replyId:t,upvoted:!0})},decrementVote({commentId:e,replyId:t=null}){this.$store.dispatch("setVote",{commentId:e,replyId:t})}}};const pe=(0,X.Z)(ue,[["render",i]]);var ge=pe,he=n(65),Ce=n(6265),ye=n.n(Ce);const we=({voting:e},t=!1)=>{switch(e){case 1:return t?-1:-2;case-1:return t?2:1;default:return t?1:-1}},_e=(0,he.MT)({state(){return{comments:[],currentUser:[]}},getters:{getAllComments({comments:e}){return e},getCurrentUser({currentUser:e}){return e}},mutations:{setComments(e,t){e.comments=t},setCurrentUser(e,t){e.currentUser=t}},actions:{init({dispatch:e}){e("initComments")},initComments:async({commit:e,dispatch:t})=>{try{const{data:{currentUser:n,comments:o}}=await ye().get("./data.json");e("setComments",o),e("setCurrentUser",n),t("loadAllComments"),t("loadCurrentUser")}catch(n){console.error(n)}},loadAllComments:async({state:e,commit:t})=>{let n=await JSON.parse(localStorage.getItem("comments"));n?t("setComments",n):localStorage.setItem("comments",JSON.stringify(e.comments))},storeComments({dispatch:e},t){localStorage.setItem("comments",JSON.stringify(t)),e("loadAllComments")},addComment:async({dispatch:e},{commentId:t,comment:n})=>{let o=await JSON.parse(localStorage.getItem("comments"));const m=o.map((e=>e.id));if(t){const m=o.findIndex((e=>e.id===t)),s=o[m].replies;if(!s.length)return o[m].replies.push({id:1,...n}),void e("storeComments",o);let r=s[s.length-1].id;return o[m].replies.push({id:r+=1,...n}),void e("storeComments",o)}o.push({id:m.length+=1,...n}),e("storeComments",o)},updateComment:async({dispatch:e},{commentId:t,replyId:n,editComment:o})=>{let m=await JSON.parse(localStorage.getItem("comments"));const s=m.findIndex((e=>e.id===t));if(n){const t=m[s].replies.findIndex((e=>e.id===n));return m[s].replies[t].content=o,void e("storeComments",m)}m[s].content=o,e("storeComments",m)},deleteComment:async({dispatch:e},{commentId:t,replyId:n})=>{let o=await JSON.parse(localStorage.getItem("comments"));const m=o.findIndex((e=>e.id===t));if(n){const t=o[m].replies.findIndex((e=>e.id===n));return o[m].replies.splice(t,1),void e("storeComments",o)}o.splice(m,1),e("storeComments",o)},setVote:async({dispatch:e},{commentId:t,replyId:n,upvoted:o=!1})=>{let m=await JSON.parse(localStorage.getItem("comments"));const s=m.find((e=>e.id===t));if(n){const t=s.replies.find((e=>e.id===n));return t.score+=we(t,o),t.voting+=we(t,o),void e("storeComments",m)}s.score+=we(s,o),s.voting+=we(s,o),e("storeComments",m)},loadCurrentUser:async({state:e,commit:t})=>{let n=await JSON.parse(localStorage.getItem("currentUser"));n?t("setCurrentUser",n):localStorage.setItem("currentUser",JSON.stringify(e.currentUser))}}});var fe=_e;(0,o.ri)(ge).use(fe).mount("#app")}},t={};function n(o){var m=t[o];if(void 0!==m)return m.exports;var s=t[o]={exports:{}};return e[o].call(s.exports,s,s.exports,n),s.exports}n.m=e,function(){var e=[];n.O=function(t,o,m,s){if(!o){var r=1/0;for(l=0;l<e.length;l++){o=e[l][0],m=e[l][1],s=e[l][2];for(var i=!0,c=0;c<o.length;c++)(!1&s||r>=s)&&Object.keys(n.O).every((function(e){return n.O[e](o[c])}))?o.splice(c--,1):(i=!1,s<r&&(r=s));if(i){e.splice(l--,1);var d=m();void 0!==d&&(t=d)}}return t}s=s||0;for(var l=e.length;l>0&&e[l-1][2]>s;l--)e[l]=e[l-1];e[l]=[o,m,s]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.p="/"}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var m,s,r=o[0],i=o[1],c=o[2],d=0;if(r.some((function(t){return 0!==e[t]}))){for(m in i)n.o(i,m)&&(n.m[m]=i[m]);if(c)var l=c(n)}for(t&&t(o);d<r.length;d++)s=r[d],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(l)},o=self["webpackChunkinteractive_comments_section"]=self["webpackChunkinteractive_comments_section"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(5648)}));o=n.O(o)})();
//# sourceMappingURL=app.13ed21f8.js.map